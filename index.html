
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.2">
    
    
      
        <title>Autoembedder</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.f56500e0.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-autoembedder" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Autoembedder" class="md-header__button md-logo" aria-label="Autoembedder" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Autoembedder
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/chrislemke/autoembedder" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Autoembedder" class="md-nav__button md-logo" aria-label="Autoembedder" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Autoembedder
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/chrislemke/autoembedder" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Code reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Code reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="learner/" class="md-nav__link">
        Learner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="data/" class="md-nav__link">
        Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="model/" class="md-nav__link">
        Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="evaluator/" class="md-nav__link">
        Evaluator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="CONTRIBUTING/" class="md-nav__link">
        How to contribute
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-dependencies" class="md-nav__link">
    Installing dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0-some-imports" class="md-nav__link">
    0. Some imports
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-create-dataloaders" class="md-nav__link">
    1. Create dataloaders
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-set-parameters" class="md-nav__link">
    2. Set parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-initialize-the-autoembedder" class="md-nav__link">
    3. Initialize the autoembedder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-train-the-model" class="md-nav__link">
    4. Train the model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-training-script" class="md-nav__link">
    Run the training script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-additional-embedding-layers" class="md-nav__link">
    Why additional embedding layers?
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  



<p><img alt="The autoembedder" src="https://raw.githubusercontent.com/chrislemke/autoembedder/master/docs/assets/images/image.png" /></p>
<h1 id="the-autoembedder">The Autoembedder<a class="headerlink" href="#the-autoembedder" title="Permanent link">&para;</a></h1>
<p><a href="https://github.com/chrislemke/autoembedder/actions/workflows/deploy-package.yml"><img alt="deploy package" src="https://github.com/chrislemke/autoembedder/actions/workflows/deploy-package.yml/badge.svg" /></a>
<a href="https://www.codacy.com/gh/chrislemke/autoembedder/dashboard?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=chrislemke/autoembedder&amp;utm_campaign=Badge_Grade"><img alt="Codacy Badge" src="https://app.codacy.com/project/badge/Grade/0d7834c236b242b6b45728acc44af37c" /></a>
<a href="https://pypi.org/project/autoembedder/"><img alt="pypi" src="https://img.shields.io/pypi/v/autoembedder" /></a>
<a href="https://python.org"><img alt="python version" src="https://img.shields.io/pypi/pyversions/autoembedder?logo=python&amp;logoColor=yellow" /></a>
<a href="https://chrislemke.github.io/autoembedder/"><img alt="docs" src="https://img.shields.io/badge/docs-mkdoks%20material-blue" /></a>
<a href="https://github.com/chrislemke/autoembedder/blob/main/LICENSE"><img alt="license" src="https://img.shields.io/github/license/chrislemke/autoembedder" /></a>
<a href="https://pypistats.org/packages/autoembedder"><img alt="downloads" src="https://img.shields.io/pypi/dm/autoembedder" /></a>
<a href="http://mypy-lang.org/"><img alt="mypy" src="http://www.mypy-lang.org/static/mypy_badge.svg" /></a>
<a href="https://github.com/psf/black"><img alt="black" src="https://img.shields.io/badge/code%20style-black-000000.svg" /></a>
<a href="https://pycqa.github.io/isort/"><img alt="isort" src="https://img.shields.io/badge/%20imports-isort-%231674b1?style=flat&amp;labelColor=ef8336" /></a>
<a href="https://github.com/pre-commit/pre-commit"><img alt="pre-commit" src="https://img.shields.io/badge/pre--commit-enabled-brightgreen?logo=pre-commit&amp;logoColor=white" /></a></p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>The Autoembedder is an autoencoder with additional embedding layers for the categorical columns. Its usage is flexible, and hyperparameters like the number of layers can be easily adjusted and tuned. The data provided for training can be either a path to a <a href="https://docs.dask.org/en/stable/dataframe.html">Dask</a> or <a href="https://pandas.pydata.org/">Pandas</a> DataFrame stored in the Parquet format or the DataFrame object directly.</p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p>If you are using <a href="https://python-poetry.org/">Poetry</a>, you can install the package with the following command:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>poetry<span class="w"> </span>add<span class="w"> </span>autoembedder
</code></pre></div>
If you are using <a href="https://pypi.org/project/pip/">pip</a>, you can install the package with the following command:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>pip<span class="w"> </span>install<span class="w"> </span>autoembedder
</code></pre></div></p>
<h2 id="installing-dependencies">Installing dependencies<a class="headerlink" href="#installing-dependencies" title="Permanent link">&para;</a></h2>
<p>With <a href="https://python-poetry.org/">Poetry</a>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>poetry<span class="w"> </span>install
</code></pre></div>
With <a href="https://pypi.org/project/pip/">pip</a>:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</code></pre></div></p>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<h3 id="0-some-imports">0. Some imports<a class="headerlink" href="#0-some-imports" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span> <span class="nn">autoembedder</span> <span class="kn">import</span> <span class="n">Autoembedder</span><span class="p">,</span> <span class="n">dataloader</span><span class="p">,</span> <span class="n">fit</span>
</code></pre></div>
<h3 id="1-create-dataloaders">1. Create dataloaders<a class="headerlink" href="#1-create-dataloaders" title="Permanent link">&para;</a></h3>
<p>First, we create two <a href="https://chrislemke.github.io/autoembedder/autoembedder.data/#autoembedder.data.Dataset.__init__"><code>dataloaders</code></a>. One for training, and the other for validation data. As <code>source</code> they either accept a path to a Parquet file, to a folder of Parquet files or a <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">Pandas</a>/<a href="https://docs.dask.org/en/stable/dataframe.html">Dask</a> DataFrame.
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">train_dl</span> <span class="o">=</span> <span class="n">dataloader</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">valid_dl</span> <span class="o">=</span> <span class="n">dataloader</span><span class="p">(</span><span class="n">vaild_df</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="2-set-parameters">2. Set parameters<a class="headerlink" href="#2-set-parameters" title="Permanent link">&para;</a></h3>
<p>Now, we need to set the parameters. They are going to be used for handling the data and training the model. In this example, only parameters for the training are set. <a href="https://github.com/chrislemke/autoembedder#parameters">Here</a> you find a list of all possible parameters. This should do it:
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="s2">&quot;hidden_layers&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="s2">&quot;verbose&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="p">}</span>
</code></pre></div></p>
<h3 id="3-initialize-the-autoembedder">3. Initialize the autoembedder<a class="headerlink" href="#3-initialize-the-autoembedder" title="Permanent link">&para;</a></h3>
<p>Then, we need to initialize the <a href="https://chrislemke.github.io/autoembedder/autoembedder.model/#autoembedder.model.Autoembedder">autoembedder</a>. In this example, we are not using any categorical features. So we can skip the <code>embedding_sizes</code> argument.
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">Autoembedder</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">num_cont_features</span><span class="o">=</span><span class="n">train_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></p>
<h3 id="4-train-the-model">4. Train the model<a class="headerlink" href="#4-train-the-model" title="Permanent link">&para;</a></h3>
<p>Everything is set up. Now we can <a href="https://chrislemke.github.io/autoembedder/autoembedder.learner/#autoembedder.learner.fit">fit</a> the model.
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">fit</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">train_dl</span><span class="p">,</span> <span class="n">valid_dl</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h2>
<p>Check out <a href="https://github.com/chrislemke/autoembedder/blob/main/example.ipynb">this Jupyter notebook</a> for an applied example using the <a href="https://www.kaggle.com/datasets/mlg-ulb/creditcardfraud">Credit Card Fraud Detection</a> from Kaggle.</p>
<h2 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h2>
<p>This is a list of all parameters that can be passed to the Autoembedder for training. When using the training script the <code>_</code> needs to be replaced with <code>-</code> and the parameters need to be passed as arguments. For boolean values please have a look at the <code>Comment</code> column for understanding how to pass them.</p>
<h2 id="run-the-training-script">Run the training script<a class="headerlink" href="#run-the-training-script" title="Permanent link">&para;</a></h2>
<p>You can also simply use the training script::
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>python3<span class="w"> </span>training.py<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>--epochs<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>--train-input-path<span class="w"> </span><span class="s2">&quot;path/to/your/train_data&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>--test-input-path<span class="w"> </span><span class="s2">&quot;path/to/your/test_data&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>--hidden-layers<span class="w"> </span><span class="s2">&quot;[[12, 6], [6, 3]]&quot;</span>
</code></pre></div></p>
<p>for help just run:
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>python3<span class="w"> </span>training.py<span class="w"> </span>--help
</code></pre></div></p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Required</th>
<th>Default value</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>batch_size</td>
<td>int</td>
<td>False</td>
<td>32</td>
<td></td>
</tr>
<tr>
<td>drop_last</td>
<td>bool</td>
<td>False</td>
<td>True</td>
<td>--drop-last / --no-drop-last</td>
</tr>
<tr>
<td>pin_memory</td>
<td>bool</td>
<td>False</td>
<td>True</td>
<td>--pin-memory / --no-pin-memory</td>
</tr>
<tr>
<td>num_workers</td>
<td>int</td>
<td>False</td>
<td>0</td>
<td>0 means that the data will be loaded in the main process</td>
</tr>
<tr>
<td>use_mps</td>
<td>bool</td>
<td>False</td>
<td>False</td>
<td>--use-mps / --no-use-mps</td>
</tr>
<tr>
<td>model_title</td>
<td>str</td>
<td>False</td>
<td>autoembedder_{<code>datetime</code>}.bin</td>
<td></td>
</tr>
<tr>
<td>model_save_path</td>
<td>str</td>
<td>False</td>
<td></td>
<td></td>
</tr>
<tr>
<td>n_save_checkpoints</td>
<td>int</td>
<td>False</td>
<td></td>
<td></td>
</tr>
<tr>
<td>lr</td>
<td>float</td>
<td>False</td>
<td>0.001</td>
<td></td>
</tr>
<tr>
<td>amsgrad</td>
<td>bool</td>
<td>False</td>
<td>False</td>
<td>--amsgrad / --no-amsgrad</td>
</tr>
<tr>
<td>epochs</td>
<td>int</td>
<td>True</td>
<td></td>
<td></td>
</tr>
<tr>
<td>dropout_rate</td>
<td>float</td>
<td>False</td>
<td>0</td>
<td>Dropout rate for the dropout layers in the encoder and decoder.</td>
</tr>
<tr>
<td>layer_bias</td>
<td>bool</td>
<td>False</td>
<td>True</td>
<td>--layer-bias / --no-layer-bias</td>
</tr>
<tr>
<td>weight_decay</td>
<td>float</td>
<td>False</td>
<td>False</td>
<td></td>
</tr>
<tr>
<td>l1_lambda</td>
<td>float</td>
<td>False</td>
<td>0</td>
<td></td>
</tr>
<tr>
<td>xavier_init</td>
<td>bool</td>
<td>False</td>
<td>False</td>
<td>--xavier-init / --no-xavier-init</td>
</tr>
<tr>
<td>activation</td>
<td>str</td>
<td>False</td>
<td>tanh</td>
<td>Activation function; either <code>tanh</code>, <code>relu</code>, <code>leaky_relu</code> or <code>elu</code></td>
</tr>
<tr>
<td>tensorboard_log_path</td>
<td>str</td>
<td>False</td>
<td></td>
<td></td>
</tr>
<tr>
<td>trim_eval_errors</td>
<td>bool</td>
<td>False</td>
<td>False</td>
<td>--trim-eval-errors / --no-trim-eval-errors; Removes the max and min loss when calculating the <code>mean loss diff</code> and <code>median loss diff</code>. This can be useful if some rows create very high losses.</td>
</tr>
<tr>
<td>verbose</td>
<td>int</td>
<td>False</td>
<td>0</td>
<td>Set this to <code>1</code> if you want to see the model summary and the validation and evaluation results. set this to <code>2</code> if you want to see the training progress bar. <code>0</code> means no output.</td>
</tr>
<tr>
<td>target</td>
<td>str</td>
<td>False</td>
<td></td>
<td>The target column. If not set no evaluation will be performed.</td>
</tr>
<tr>
<td>train_input_path</td>
<td>str</td>
<td>True</td>
<td></td>
<td></td>
</tr>
<tr>
<td>test_input_path</td>
<td>str</td>
<td>True</td>
<td></td>
<td></td>
</tr>
<tr>
<td>eval_input_path</td>
<td>str</td>
<td>False</td>
<td></td>
<td>Path to the evaluation data. If no path is provided no evaluation will be performed.</td>
</tr>
<tr>
<td>hidden_layers</td>
<td>str</td>
<td>True</td>
<td></td>
<td>Contains a string representation of a list of list of integers which represents the hidden layer structure. E.g.: <code>"[[64, 32], [32, 16], [16, 8]]"</code> activation</td>
</tr>
<tr>
<td>cat_columns</td>
<td>str</td>
<td>False</td>
<td>"[]"</td>
<td>Contains a string representation of a list of list of categorical columns (strings). The columns which use the same encoder should be together in a list. E.g.: <code>"[['a', 'b'], ['c']]"</code>.</td>
</tr>
<tr>
<td>drop-cat-columns</td>
<td>bool</td>
<td>False</td>
<td></td>
<td>--drop-cat-columns / --no-drop-cat-columns</td>
</tr>
</tbody>
</table>
<h2 id="why-additional-embedding-layers">Why additional embedding layers?<a class="headerlink" href="#why-additional-embedding-layers" title="Permanent link">&para;</a></h2>
<p>The additional embedding layers automatically embed all columns with the Pandas <code>category</code> data type. If categorical columns have another data type, they will not be embedded and will be handled like continuous columns. Simply encoding the categorical values (e.g., with the usage of a label encoder) decreases the quality of the outcome.</p>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.tracking", "navigation.top", "navigation.expand"], "search": "assets/javascripts/workers/search.12658920.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.5cf534bf.min.js"></script>
      
        <script src="javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="javascripts/tablesort.js"></script>
      
    
  </body>
</html>